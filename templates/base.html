<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Schema Explorer{% endblock %} - ACAD-GIS</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="grid-background">
    <header class="header">
        <div class="header-content">
            <div class="header-title">
                <i class="fas fa-database neon-blue"></i>
                <div>
                    <h1 class="orbitron">ACAD-GIS Schema Explorer</h1>
                    <div class="header-subtitle">Database Management & Viewer</div>
                </div>
            </div>
            <nav class="nav">
                <a href="/" {% if request.path == '/' %}class="active"{% endif %}>
                    <i class="fas fa-home"></i> Home
                </a>
                <a href="/schema" {% if request.path == '/schema' %}class="active"{% endif %}>
                    <i class="fas fa-table"></i> Schema
                </a>
                <a href="/schema/relationships" {% if request.path == '/schema/relationships' %}class="active"{% endif %}>
                    <i class="fas fa-project-diagram"></i> Relationships
                </a>
                <a href="/projects" {% if request.path == '/projects' %}class="active"{% endif %}>
                    <i class="fas fa-folder"></i> Projects
                </a>
                <a href="/drawings" {% if request.path == '/drawings' %}class="active"{% endif %}>
                    <i class="fas fa-file-image"></i> Drawings
                </a>
                <a href="/data-manager" {% if request.path.startswith('/data-manager') %}class="active"{% endif %}>
                    <i class="fas fa-database"></i> Data Manager
                </a>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    <script>
        async function checkHealth() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                return data.status === 'connected';
            } catch {
                return false;
            }
        }

        async function deleteItem(endpoint, id, itemName) {
            if (!confirm(`Are you sure you want to delete ${itemName}?`)) {
                return;
            }

            try {
                const response = await fetch(`${endpoint}/${id}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    location.reload();
                } else {
                    const error = await response.json();
                    alert(`Error: ${error.error || 'Failed to delete'}`);
                }
            } catch (error) {
                alert(`Error: ${error.message}`);
            }
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>
